# ğŸ¨ Arquitectura del Proyecto DevOps - Casa de Cambios

## Diagrama de Arquitectura Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   USUARIOS                                     â”‚
â”‚                         (Navegador Web / AplicaciÃ³n)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTP/HTTPS
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AWS Cloud - us-west-1                                 â”‚
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    VPC (Virtual Private Cloud)                           â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚            Security Group: devops-casa-cambios-sg                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Inbound Rules:                                                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - SSH (22)         â† GitHub Actions, Admin                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - HTTP (80)        â† Public                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Backend (3000)   â† Public                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Grafana (3001)   â† Public                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Prometheus (9090) â† Public                                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Node Exp. (9100) â† Prometheus                                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - cAdvisor (8080)  â† Prometheus                                   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚        EC2 Instance: devops-casa-cambios (t3.small)                â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        Public IP: 13.56.79.41 (Elastic IP)                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        OS: Amazon Linux 2023                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        Storage: 20 GB EBS (gp3)                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚        Swap: 4 GB                                                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚           Docker Engine + Docker Compose                     â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                              â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚         Application Stack (app-network)                â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚   Frontend   â”‚   â”‚   Backend   â”‚   â”‚PostgreSQL â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚   â”‚             â”‚   â”‚           â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ React + Vite â”‚â—„â”€â”€â”¤  Node.js    â”‚â—„â”€â”€â”¤   15-     â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ TypeScript   â”‚   â”‚  + Express  â”‚   â”‚   alpine  â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Material-UI  â”‚   â”‚  + pg       â”‚   â”‚           â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚   â”‚             â”‚   â”‚           â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Port: 80    â”‚   â”‚ Port: 3000  â”‚   â”‚Port: 5432 â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚   â”‚             â”‚   â”‚           â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Apache httpdâ”‚   â”‚ Auth: JWT   â”‚   â”‚ Volume:   â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  SPA Mode    â”‚   â”‚ CORS enabledâ”‚   â”‚postgres   â”‚  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€dataâ”€â”€â”˜  â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                             â”‚                         â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                             â”‚ Logs                    â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                             â–¼                         â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                      Volume: logs                     â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                              â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      Observability Stack (app-network)                 â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                                        â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚         Metrics Collection Layer                  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                   â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚   Node     â”‚  â”‚   cAdvisor   â”‚  â”‚Prometheusâ”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Exporter  â”‚  â”‚              â”‚  â”‚          â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚            â”‚  â”‚  Container   â”‚  â”‚  Metrics â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ EC2 Metricsâ”‚â”€â–ºâ”‚   Metrics    â”‚â”€â–ºâ”‚  Server  â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚            â”‚  â”‚              â”‚  â”‚          â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ CPU, RAM,  â”‚  â”‚  Docker Statsâ”‚  â”‚Scrape 15sâ”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Disk, Net  â”‚  â”‚              â”‚  â”‚          â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚            â”‚  â”‚              â”‚  â”‚ Retentionâ”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚Port: 9100  â”‚  â”‚  Port: 8080  â”‚  â”‚  15 days â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                           â”‚      â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                     Port: 9090   â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                     Volume:      â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                   prometheus_dataâ”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                         â”‚                             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚         Logs Collection Layer                    â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚   Promtail   â”‚         â”‚      Loki        â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚         â”‚                  â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Log Collectorâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Log Aggregator  â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚         â”‚                  â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Docker logs  â”‚  Push   â”‚  Label-based     â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ File logs    â”‚         â”‚  indexing        â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚              â”‚         â”‚                  â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Port: 9080   â”‚         â”‚  Port: 3100      â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  Volume:         â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                           â”‚  loki_data       â”‚  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                        â”‚             â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚       Visualization Layer                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                                â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚             Grafana                      â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                          â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Datasources:                            â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  âœ“ Prometheus (metrics)                  â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  âœ“ Loki (logs)                           â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                          â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Dashboards:                             â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ EC2 Infrastructure Monitoring         â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Application Logs Dashboard            â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                          â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Auth: admin / admin123                  â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Port: 3001 (3000 internal)              â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Volume: grafana_data                    â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Elastic IP: 13.56.79.41                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ SSH (GitHub Actions)
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CI/CD Pipeline                                     â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      GitHub Repository                               â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚   Code     â”‚   â”‚Dockerfiles â”‚   â”‚docker-comp â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚  (Front+   â”‚   â”‚            â”‚   â”‚   ose.yml  â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚   Back)    â”‚   â”‚            â”‚   â”‚            â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ Monitoring â”‚   â”‚  Terraform â”‚   â”‚  Workflows â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚   Config   â”‚   â”‚   Files    â”‚   â”‚   (.github)â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                               â”‚
â”‚                           â”‚ Push to main/master                           â”‚
â”‚                           â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    GitHub Actions Workflow                           â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Step 1: Build                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Checkout code                                               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Set up Node.js                                              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Install dependencies (Backend + Frontend)                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Build Docker images                                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Save images as artifacts                                    â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Step 2: Deploy                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Download artifacts                                          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Configure SSH (using EC2_SSH_KEY secret)                    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Copy files to EC2 (SCP)                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ SSH to EC2 and execute:                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    - docker load (images)                                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    - docker-compose down                                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    - docker-compose up -d                                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Verify deployment                                           â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚  Step 3: Notify                                                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Send Discord webhook                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    - âœ… Success: commit SHA, author, URLs                      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    - âŒ Failure: error details, logs link                      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Webhook
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Discord Channel                                  â”‚
â”‚                                                                            â”‚
â”‚  ğŸ“¢ Casa Cambios CI/CD                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœ… Despliegue Exitoso - Casa de Cambios                             â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚ Commit: abc1234                                                      â”‚ â”‚
â”‚  â”‚ Autor: tu-usuario                                                    â”‚ â”‚
â”‚  â”‚ Rama: main                                                           â”‚ â”‚
â”‚  â”‚ Mensaje: "feat: Add new feature"                                     â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚ URLs:                                                                â”‚ â”‚
â”‚  â”‚ â€¢ App: http://13.56.79.41                                           â”‚ â”‚
â”‚  â”‚ â€¢ Grafana: http://13.56.79.41:3001                                  â”‚ â”‚
â”‚  â”‚ â€¢ Prometheus: http://13.56.79.41:9090                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flujo de Datos

### 1. Flujo de AplicaciÃ³n (LÃ­nea Azul)
```
Usuario â†’ Frontend (Port 80) â†’ Backend API (Port 3000) â†’ PostgreSQL (Port 5432)
```

### 2. Flujo de MÃ©tricas (LÃ­nea Verde)
```
EC2 System â†’ Node Exporter (Port 9100) â”
                                        â”œâ†’ Prometheus (Port 9090) â†’ Grafana
Docker Containers â†’ cAdvisor (Port 8080)â”˜
```

### 3. Flujo de Logs (LÃ­nea Amarilla)
```
Docker Containers â†’ Promtail (Port 9080) â†’ Loki (Port 3100) â†’ Grafana
Backend Files     â”˜
```

### 4. Flujo de CI/CD (LÃ­nea Roja)
```
Git Push â†’ GitHub Actions â†’ Build â†’ Test â†’ Deploy to EC2 â†’ Discord Notification
```

## Puertos y Servicios

| Puerto | Servicio | DescripciÃ³n | Acceso |
|--------|----------|-------------|---------|
| 80 | Frontend | React SPA | PÃºblico |
| 3000 | Backend | Node.js API | PÃºblico |
| 3001 | Grafana | Dashboards | PÃºblico |
| 3100 | Loki | Log Server | Interno |
| 5432 | PostgreSQL | Database | Interno |
| 8080 | cAdvisor | Container Metrics | PÃºblico |
| 9080 | Promtail | Log Collector | Interno |
| 9090 | Prometheus | Metrics Server | PÃºblico |
| 9100 | Node Exporter | System Metrics | PÃºblico |
| 22 | SSH | Remote Access | Admin/CI/CD |

## VolÃºmenes Docker

| Volumen | PropÃ³sito | Persistencia |
|---------|-----------|--------------|
| postgres_data | Base de datos | âœ… Persistente |
| prometheus_data | MÃ©tricas histÃ³ricas | âœ… Persistente |
| loki_data | Logs histÃ³ricos | âœ… Persistente |
| grafana_data | Dashboards y config | âœ… Persistente |
| logs | Logs de backend | âœ… Persistente |

## Recursos de Infraestructura

### EC2 Instance (t3.small)
- **vCPUs:** 2
- **RAM:** 2 GB
- **Storage:** 20 GB EBS (gp3)
- **Swap:** 4 GB
- **Network:** Enhanced Networking

### EstimaciÃ³n de Uso de Memoria

| Servicio | Memoria Estimada |
|----------|------------------|
| Frontend | ~50 MB |
| Backend | ~100 MB |
| PostgreSQL | ~150 MB |
| Prometheus | ~200 MB |
| Grafana | ~150 MB |
| Loki | ~100 MB |
| Node Exporter | ~20 MB |
| cAdvisor | ~50 MB |
| Promtail | ~30 MB |
| **Sistema + Docker** | ~500 MB |
| **TOTAL** | ~1.35 GB |
| **Buffer/Swap** | 4 GB |

## Estrategia de Monitoreo

### MÃ©tricas Clave (Prometheus)

1. **CPU:**
   - `node_cpu_seconds_total` - Uso de CPU por modo
   - Target: < 80% utilizaciÃ³n

2. **Memoria:**
   - `node_memory_MemAvailable_bytes` - Memoria disponible
   - Target: > 20% disponible

3. **Disco:**
   - `node_filesystem_avail_bytes` - Espacio disponible
   - Target: > 2 GB libre

4. **Red:**
   - `node_network_receive_bytes_total` - TrÃ¡fico entrante
   - `node_network_transmit_bytes_total` - TrÃ¡fico saliente

### Logs Clave (Loki)

1. **Backend Logs:**
   - Request logs
   - Error logs
   - Authentication logs

2. **Frontend Logs:**
   - Access logs
   - Error logs

3. **System Logs:**
   - Docker container logs
   - Service start/stop events

## Seguridad

### Security Group Rules

**Inbound:**
- SSH (22) - Solo desde IPs confiables
- HTTP (80) - PÃºblico
- Backend (3000) - PÃºblico
- Grafana (3001) - PÃºblico (considerar restringir)
- Prometheus (9090) - PÃºblico (considerar restringir)

**Outbound:**
- All traffic - Permitido

### Secretos y Credenciales

| Secreto | UbicaciÃ³n | PropÃ³sito |
|---------|-----------|-----------|
| EC2_SSH_KEY | GitHub Secrets | Despliegue automatizado |
| DISCORD_WEBHOOK_URL | GitHub Secrets | Notificaciones |
| DB_PASSWORD | .env en EC2 | Acceso a DB |
| GRAFANA_PASSWORD | .env en EC2 | Acceso a Grafana |

**IMPORTANTE:** Nunca commitear .env o archivos .pem al repositorio.

## Proceso de Despliegue

1. **Desarrollo Local**
   - Desarrollar feature
   - Probar localmente
   - Commit y push a branch

2. **PR y Review**
   - Crear Pull Request
   - Code review
   - Merge a main/master

3. **CI/CD AutomÃ¡tico**
   - GitHub Actions se dispara
   - Build de imÃ¡genes Docker
   - Tests (si existen)
   - Deploy a EC2
   - VerificaciÃ³n
   - NotificaciÃ³n a Discord

4. **VerificaciÃ³n Post-Deploy**
   - Revisar notificaciÃ³n en Discord
   - Verificar servicios en EC2
   - Revisar logs en Grafana
   - Verificar mÃ©tricas en Grafana

## Disaster Recovery

### Backup

**AutomÃ¡tico:**
- VolÃºmenes Docker persisten en EBS
- EBS snapshots (configurar manualmente en AWS)

**Manual:**
```bash
# Backup de base de datos
docker exec casa-cambios-db pg_dump -U postgres casacambios > backup.sql

# Backup de Grafana
docker exec grafana cp -r /var/lib/grafana /backup
```

### Restore

```bash
# Restaurar base de datos
cat backup.sql | docker exec -i casa-cambios-db psql -U postgres casacambios

# Restaurar Grafana
docker cp backup/grafana grafana:/var/lib/
docker-compose restart grafana
```

## Escalabilidad Futura

### Mejoras Posibles

1. **Load Balancer** - AWS ALB para mÃºltiples instancias
2. **RDS** - Base de datos gestionada
3. **ECS/EKS** - OrquestaciÃ³n de contenedores
4. **CloudWatch** - Monitoreo adicional de AWS
5. **S3** - Almacenamiento de logs/backups
6. **Auto Scaling** - Escalado automÃ¡tico
7. **CDN** - CloudFront para frontend

---

**Nota:** Este diagrama representa la arquitectura completa del proyecto DevOps. AsegÃºrate de mantenerlo actualizado si haces cambios en la infraestructura.
